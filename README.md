# Repository Structure

The `study_data_analysis` folder contains our study data. The `LLM_intervention_software_generation` folder contains code to reproduce intervention software from prescribed exercises designed by study participants. (To access system prompt, search for ``system prompt'' in this README.)

## Participant Study Data

The `study_data_analysis/participant_study_data` folder contains individual participant data organized into 20 subdirectories (P1 through P20), each corresponding to a unique participant ID.

Each participant subdirectory contains the following structure:

### 1. `instructions` folder
Contains two JSON files with instructions for the two exercises designed by each participant.

### 2. `results` folder
Contains two JSON files with comparison results between participant binary labels and LLM-generated software monitored binary labels.

**Binary Label Definitions:**
- `True`: Patient completed the instruction
- `False`: Patient did not complete the instruction (incompletion)

**JSON Structure:**
```json
{
  "stepsAccuracy": "percentage of instructions judged to be adequately paced by the participant",
  "successfulFailedOmittedAccuracy": "percentage of software's monitored labels that match the participant's labels",
  "therapistReport": {
    "exerciseStep": "participant's prescribed instructions",
    "successfulInstructions": "participant's pre-labels"
  },
  "llmReport": {
    "exerciseStep": "participant's prescribed instructions", 
    "successfulInstructions": "software's monitored labels"
  }
}
```

### 3. `scenic_programs` folder
Contains two Scenic programs (intervention software) generated by the LLM for each participant.

### 4. `summaries` folder
Contains logs of monitored data collected by the two Scenic programs.

## Exercises used in the Study

The `study_data_analysis/prescribed_exercises` folder contains exercise-related study data:

- **`template.txt`**: Worksheet instructions prepared by study personnel for each of the 10 exercise goals
- **`ex1.txt` through `ex10.txt`**: Ten files corresponding to 10 exercise goals, where each file contains instructions from 4 exercises designed by 4 different therapists

*Note: Each exercise goal has 4 exercises designed by 4 therapists, resulting in 40 total exercise variations across 10 goals.*

## Analysis Instructions

Follow these steps to reproduce the analysis and generate the results:

### Step 1: Set up Python Environment
Create a Python virtual environment with Python version 3.11:

```bash
python3.11 -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
```

### Step 2: Install Python Dependencies
Install the required packages using the requirements file:

```bash
pip install -r requirements.txt
```

### Step 3: Generate Monitoring Analysis Data
Run the data loading script to generate the CSV file for analysis:

```bash
cd study_data_analysis
python summarize_study_data.py
```

This will create a `study_data_summary.csv` file within `study_data_analysis` folder. The description of the data columns included in this CSV is documented in the `summarize_study_data()` function within the script.

### Step 4: Install R Software
Install R software version 4.5.1 (or compatible version) from [https://www.r-project.org/](https://www.r-project.org/).

### Step 5: Generate Figure 3
Run the R script to generate the forest plot (Figure 3 in the paper):

```bash
Rscript --vanilla monitoring_analysis.R 
```

This command will process the generated CSV file and create the forest plot visualization.

## Requirements

- **Python**: Version 3.11
- **R**: Version 4.5.1 (used for this analysis)
- **Dependencies**: Listed in `requirements.txt`

## Output

The analysis will generate:
- `study_data_summary.csv`: Summarizing our study data
- Forest plot visualization (Figure 3 from the associated paper)

## Data Description
For detailed information about the data columns and structure in the generated CSV file, refer to the annotations in the `summarize_study_data()` function in `summarize_study_data.py`.

## Reproducing Intervention Software
In `LLM_intervention_software_generation` folder c

### System Prompt
#### Coding Guideline
This can be found in `software_generator()` function within `LLM_intervention_software_generation/software_generation_code/intervention_software_generator.py`.  

### API Library
The library of APIs can be found in `LLM_intervention_software_generation/software_generation_code//Scenic-main/Scenic/src/scenic/simulators/unity/actions.py`.

#### Programming Language Documentation
The webpage link to Scenic programming language website detailing the syntax and semantics of the language is included in the Coding Guidelines. 

#### Example Programs
They are in `LLM_intervention_software_generation/software_generation_code/example_scenic_program` folder. 

### Intervention Software Generation
First, find a json file containing the instructions prescribed by a study participant from `study_data_analysis/study_data` folder. 
Each participant (P1, ..., P20) has `instructions` folder which contains two .json files containing the prescribed exercises.

Second, copy-paste a .json file into `LLM_intervention_software_generation/software_generation_code/json` folder and rename the file to `exercise.json`

Third, open jupyter notebook by executing the following in your terminal:
```bash
jupyter notebook
```

Fourth, open `LLM_intervention_software_generation/software_generation_code/software_generation.ipynb` and run the cells. This will generate the intervention software in `LLM_intervention_software_generation/software_generation_code/scenic_output` folder as `exercise.scenic` file. 
